<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Superradiant Laser using Symbolic Summations · QuantumCumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">QuantumCumulants.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li><a class="tocitem" href="../many-atom-laser/">Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li><a class="tocitem" href="../superradiant-laser/">Superradiant Laser</a></li><li><a class="tocitem" href="../excitation-transport-chain/">Noisy excitation transport</a></li><li><a class="tocitem" href="../cavity_antiresonance/">Cavity Antiresonance</a></li><li><a class="tocitem" href="../ramsey_spectroscopy/">Ramsey Spectroscopy</a></li><li class="is-active"><a class="tocitem" href>Superradiant Laser using Symbolic Summations</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Spectrum"><span>Spectrum</span></a></li></ul></li><li><a class="tocitem" href="../cavity_antiresonance_indexed/">Cavity Antiresonance using Symbolic Summations</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Superradiant Laser using Symbolic Summations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Superradiant Laser using Symbolic Summations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/superradiant_laser_indexed.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Superradiant-Laser-using-Symbolic-Summations"><a class="docs-heading-anchor" href="#Superradiant-Laser-using-Symbolic-Summations">Superradiant Laser using Symbolic Summations</a><a id="Superradiant-Laser-using-Symbolic-Summations-1"></a><a class="docs-heading-anchor-permalink" href="#Superradiant-Laser-using-Symbolic-Summations" title="Permalink"></a></h1><p>We can use the implemented indexing and summation features to calculate the Superradiant Laser example. Here we take advantage of these functionalities to simplify the definition of our Hamiltonian and the completion of the resulting equations of motion. The Hamiltonian of the system is once again given as:</p><p class="math-container">\[H = - \hbar \Delta a^\dagger a +  \hbar \sum\limits_{j=1}^{N}  g_j (a^\dagger \sigma^{12}_{j} + a \sigma^{21}_{j}),\]</p><p>where <span>$\Delta = \omega_a - \omega_c$</span> is the detuning between the cavity (<span>$\omega_c$</span>) and the atomic (<span>$\omega_a$</span>) resonance frequency, the atom cavity coupling of the atom <span>$j$</span> is denoted by <span>$g_j$</span>. Additionally there are dissipative processes in the system, namely: Atoms are incoherently pumped with the rate <span>$R$</span>, they decay individually with the rate <span>$\Gamma$</span> and are affected by individual atomic dephasing with the rate <span>$\nu$</span>. Photons also leak out of the system with the rate <span>$\kappa$</span>.</p><p>First of all we need to load the needed packages:</p><pre><code class="language-">using QuantumCumulants
using OrdinaryDiffEq, SteadyStateDiffEq, ModelingToolkit, DifferentialEquations
using Plots
nothing #hide</code></pre><p>We continue by defining some of our parameters needed as <span>$@cnumbers$</span>, as well as the order of the cumulant expansion we want to have. Further more we define the Hilberspaces for our system, in this case our system consists of a <strong>FockSpace</strong> (the cavity) and a <strong>NLevelSpace</strong> (the atoms). It is important to note here, that we do not need to construct multiple <strong>NLevelSpaces</strong> for different atoms, since we can use the features of indices, which allow us to distinguish between different atoms in the calculation.</p><pre><code class="language-julia">order = 2 #order of the cumulant expansion
@cnumbers N Δ g κ Γ R ν

# Hilbertspace
hc = FockSpace(:cavity)
ha = NLevelSpace(:atom,2)

h = hc ⊗ ha</code></pre><pre><code class="language-none">ℋ(cavity) ⊗ ℋ(atom)</code></pre><p>In the next step we define those indices by using the constructor <strong>Index</strong>. Here we create several indices at once, since we want to use different indices for different atoms. However, each of the defined <strong>Index</strong> objects has the same range <strong>N</strong> and are defined on the same sub-Hilbertspace <strong>ha</strong>. We can further use these indices to define <strong>IndexedOperator</strong> objects, which are operators associated with an <strong>Index</strong>. Here we also create the Hamiltonian of the System using the symbolic Summation function <strong>Σ</strong>, which creates summation objects.</p><pre><code class="language-julia"># Indices and Operators
i = Index(h,:i,N,ha)
k = Index(h,:k,N,ha)
l = Index(h,:l,N,ha)

@qnumbers a::Destroy(h)
σ(i,j,k) = IndexedOperator(Transition(h,:σ,i,j),k)

# Define the Hamiltonian
H = -Δ*a&#39;a + g*(Σ(a&#39;*σ(1,2,i),i) + Σ(a*σ(2,1,i),i))</code></pre><p class="math-container">\[\underset{i}{\overset{N}{\sum}} g  a^\dagger  {\sigma}_{i}^{{12}} + \underset{i}{\overset{N}{\sum}} g  a  {\sigma}_{i}^{{21}} -1 \Delta a^\dagger a\]</p><p>In the next step we proceed by defining the dissipation operators with their corresponding dissipation rates and the operators, for which we want to calculate the equations of motion. In the final line of this code-block we calculate the meanfield eqautions using the <strong>indexed_meanfield</strong> function, which uses the features of symbolic summations.</p><pre><code class="language-julia"># Define Jump-Operators with corresponding rates
J = [a,σ(1,2,l),σ(2,1,l),σ(2,2,l)]
rates = [κ, Γ, R, ν]

# Define Operators, for which the meanfield shall be calculated
ops = [a&#39;*a,σ(2,2,k)]

# It is best-practice to use every Index-Entity in only one context

# create Meanfield-Equations with given order for the given operators
eqs = indexed_meanfield(ops,H,J;rates=rates,order=order)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; 1 i \underset{i}{\overset{N}{\sum}} g  \langle a  {\sigma}_{i}^{{21}}\rangle  -1 i \underset{i}{\overset{N}{\sum}} g  \langle a^\dagger  {\sigma}_{i}^{{12}}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{k}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{k}^{{22}}\rangle  + 1 i g \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -1.0 \Gamma \langle {\sigma}_{k}^{{22}}\rangle  -1 i g \langle a  {\sigma}_{k}^{{21}}\rangle 
\end{align}\]</p><p>To get a closed set of equations we automatically complete the system. Since this system is phase invariant we know that all averages with a phase are zero, therefore we exclude these terms with a filter function.</p><pre><code class="language-julia"># custom filter function
# Using the filter function defined below, one can reduce the size of the complete system to only contain phase-invariant terms
φ(x::Average) = φ(x.arguments[1])
φ(::Destroy) = -1
φ(::Create) =1
φ(x::QTerm) = sum(map(φ, x.args_nc))
φ(x::Transition) = x.i - x.j
φ(x::IndexedOperator) = x.op.i - x.op.j
φ(x::IndexedSingleSum) = φ(x.term)
φ(x::AvgSums) = φ(arguments(x))
phase_invariant(x) = iszero(φ(x))


# We use the extraIndices keyword to provide names for indices, that are needed for intermediate calculation
eqs_c = complete(eqs;filter_func=phase_invariant,scaling=false,extra_indices=[:q])</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; 1 i \underset{i}{\overset{N}{\sum}} g  \langle a  {\sigma}_{i}^{{21}}\rangle  -1 i \underset{i}{\overset{N}{\sum}} g  \langle a^\dagger  {\sigma}_{i}^{{12}}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{k}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{k}^{{22}}\rangle  + 1 i g \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -1.0 \Gamma \langle {\sigma}_{k}^{{22}}\rangle  -1 i g \langle a  {\sigma}_{k}^{{21}}\rangle  \\
\frac{d}{dt} \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  =&amp; 1 i \underset{i{\ne}k}{\overset{N}{\sum}} g  \langle {\sigma}_{i}^{{21}}  {\sigma}_{k}^{{12}}\rangle  + 1 i g \langle {\sigma}_{k}^{{22}}\rangle  -1 i g \langle a^\dagger  a\rangle  -0.5 R \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -0.5 \Gamma \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -0.5 \kappa \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -0.5 \nu \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -1 i \Delta \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  + 2 i g \langle {\sigma}_{k}^{{22}}\rangle  \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{k}^{{12}}  {\sigma}_{q}^{{21}}\rangle  =&amp; -1.0 R \langle {\sigma}_{k}^{{12}}  {\sigma}_{q}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma}_{k}^{{12}}  {\sigma}_{q}^{{21}}\rangle  -1.0 \nu \langle {\sigma}_{k}^{{12}}  {\sigma}_{q}^{{21}}\rangle  + 1.0 i g \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  -1.0 i g \langle a  {\sigma}_{q}^{{21}}\rangle  -2.0 i g \langle {\sigma}_{q}^{{22}}\rangle  \langle a^\dagger  {\sigma}_{k}^{{12}}\rangle  + 2.0 i g \langle {\sigma}_{k}^{{22}}\rangle  \langle a  {\sigma}_{q}^{{21}}\rangle 
\end{align}\]</p><p>The equations, that we got in the previous step can now be easily adjusted for different purposes. We assume here all atoms in the system behave identically. We can then simply reduce the above equations to equations for specific atoms (atom 1,2,3...) by using the <strong>scale</strong> function.</p><pre><code class="language-julia"># Now one can easily scale the Equations above
eqs_sc = scale(eqs_c)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 \kappa \langle a^\dagger  a\rangle  -1 i N g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 1 i N g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle ^* \\
\frac{d}{dt} \langle {\sigma}_{1}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{1}^{{22}}\rangle  + 1 i g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -1 i g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle ^* -1.0 \Gamma \langle {\sigma}_{1}^{{22}}\rangle  \\
\frac{d}{dt} \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  =&amp; 1 i g \langle {\sigma}_{1}^{{22}}\rangle  -1 i g \langle a^\dagger  a\rangle  -0.5 R \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \Gamma \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \kappa \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -1 i \Delta \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \nu \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 2 i g \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  a\rangle  + 1 i g \left( -1 + N \right) \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  \\
\frac{d}{dt} \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  =&amp; -1.0 R \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  -1.0 \nu \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  + 1.0 i g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -1.0 i g \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle ^* -2.0 i g \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 2.0 i g \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle ^*
\end{align}\]</p><p>To calculate the dynamics of the system we create a system of ordinary differential equations, which can be used by <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>. Furthermore we define the numerical parameters as well as the initial state of the system and solve the system in the next step.</p><pre><code class="language-"># define the ODE System and Problem
@named sys = ODESystem(eqs_sc)

# Initial state
u0 = zeros(ComplexF64, length(eqs_sc))
# System parameters
N_ = 2e5
Γ_ = 1.0 #Γ=1mHz
Δ_ = 2500Γ_ #Δ=2.5Hz
g_ = 1000Γ_ #g=1Hz
κ_ = 5e6*Γ_ #κ=5kHz
R_ = 1000Γ_ #R=1Hz
ν_ = 1000Γ_ #ν=1Hz

ps = [N, Δ, g, κ, Γ, R, ν]
p0 = [N_, Δ_, g_, κ_, Γ_, R_, ν_]

prob = ODEProblem(sys,u0,(0.0, 1.0/50Γ_), ps.=&gt;p0)
nothing #hide</code></pre><pre><code class="language-"># Solve the Problem
sol = solve(prob,maxiters=1e7)

# Plot time evolution
t = sol.t
n = real.(sol[a&#39;a])
s22 = real.(sol[σ(2,2,1)])
# Plot
p1 = plot(t, n, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨a⁺a⟩&quot;, legend=false)
p2 = plot(t, s22, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨σ22⟩&quot;, legend=false)
plot(p1, p2, layout=(1,2), size=(700,300))
savefig(&quot;superradiant_laser_indexed.svg&quot;) # hide</code></pre><p><img src="superradiant_laser_indexed.svg" alt="svg"/>    </p><h1 id="Spectrum"><a class="docs-heading-anchor" href="#Spectrum">Spectrum</a><a id="Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Spectrum" title="Permalink"></a></h1><p>We can now calculate the spectrum using the Laplace transform of the two-ime correlation function. This is done here with the <strong>Spectrum</strong> function.</p><pre><code class="language-"># For the Spectrum 
# setting the scaling keyword attribute to true gives us again a output in similar form to scale(eqs_c)
corr = CorrelationFunction(a&#39;, a, eqs_c; steady_state=true, filter_func=phase_invariant,scaling=true);
S = Spectrum(corr, ps)
nothing #hide</code></pre><p>The set of equations for the correlation function is then given by:</p><pre><code class="language-julia">corr.de</code></pre><p class="math-container">\[\begin{align}
\frac{d}{d\tau} \langle a^\dagger  a_0\rangle  =&amp; -0.5 \kappa \langle a^\dagger  a_0\rangle  -1 i \Delta \langle a^\dagger  a_0\rangle  + 1 i N g \langle a_0  {\sigma}_{1}^{{21}}\rangle  \\
\frac{d}{d\tau} \langle a_0  {\sigma}_{1}^{{21}}\rangle  =&amp; -0.5 R \langle a_0  {\sigma}_{1}^{{21}}\rangle  -0.5 \Gamma \langle a_0  {\sigma}_{1}^{{21}}\rangle  -0.5 \nu \langle a_0  {\sigma}_{1}^{{21}}\rangle  + 1 i g \langle a^\dagger  a_0\rangle  -2 i g \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  a_0\rangle 
\end{align}\]</p><p>To ensure we are in the steady state we use a steady solver to calculate it. To this end we need to define the SteadyStateProblem and specify the desired method. We also need to increase the maxiters and the solver accuracy to handle this numerically involved problem.</p><pre><code class="language-">prob_ss = SteadyStateProblem(prob)
sol_ss = solve(prob_ss, DynamicSS(Tsit5(); abstol=1e-8, reltol=1e-8),
    reltol=1e-14, abstol=1e-14, maxiters=5e7)
nothing #hide</code></pre><pre><code class="language-">ω = [-10:0.01:10;]Γ_
spec = S(ω,sol_ss.u,p0)
spec_n = spec ./ maximum(spec)
δ = abs(ω[(findmax(spec)[2])])
nothing #hide</code></pre><pre><code class="language-">plot(ω, spec_n, xlabel=&quot;ω/Γ&quot;, legend=false, size=(500,300))
savefig(&quot;superradiant_laser_indexed_spectrum.svg&quot;) # hide</code></pre><p><img src="superradiant_laser_indexed_spectrum.svg" alt="svg"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ramsey_spectroscopy/">« Ramsey Spectroscopy</a><a class="docs-footer-nextpage" href="../cavity_antiresonance_indexed/">Cavity Antiresonance using Symbolic Summations »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 21 October 2022 14:35">Friday 21 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
