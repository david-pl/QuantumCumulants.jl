<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Superradiant Laser · QuantumCumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">QuantumCumulants.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../symbolic_sums/">Symbolic Sums and Indices</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li><a class="tocitem" href="../many-atom-laser/">Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li><a class="tocitem" href="../excitation-transport-chain/">Noisy excitation transport</a></li><li><a class="tocitem" href="../ramsey_spectroscopy/">Ramsey Spectroscopy</a></li><li class="is-active"><a class="tocitem" href>Superradiant Laser</a><ul class="internal"><li><a class="tocitem" href="#Spectrum"><span>Spectrum</span></a></li></ul></li><li><a class="tocitem" href="../cavity_antiresonance_indexed/">Cavity Antiresonance</a></li><li><a class="tocitem" href="../filter-cavity_indexed/">Laser with Filter Cavities</a></li><li><a class="tocitem" href="../superradiant-laser/">Superradiant Laser (outdated)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Superradiant Laser</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Superradiant Laser</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/superradiant_laser_indexed.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Superradiant-Laser"><a class="docs-heading-anchor" href="#Superradiant-Laser">Superradiant Laser</a><a id="Superradiant-Laser-1"></a><a class="docs-heading-anchor-permalink" href="#Superradiant-Laser" title="Permalink"></a></h1><p>Using symmetry properties of a system can reduce the number of needed equations dramatically. A common approximation for laser systems to handle sufficiently big atom numbers is to assume that several atoms in the system behave completely identically. This means all the identical atoms have the same averages.</p><p>In this example we describe a so-called superradiant laser, where we assume all atoms to be identical. This model has been described in <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.102.163601">D. Meiser et al., Phys. Rev. Lett. 102, 163601 (2009):</a> The Hamiltonian of this system is</p><p class="math-container">\[\begin{equation}
H = - \hbar \Delta a^\dagger a +  \hbar \sum\limits_{j=1}^{N}  g_j (a^\dagger \sigma^{12}_{j} + a \sigma^{21}_{j}) ,
\end{equation}\]</p><p>where <span>$\Delta = \omega_a - \omega_c$</span> is the detuning between the cavity (<span>$\omega_c$</span>) and the atomic (<span>$\omega_a$</span>) resonance frequency, the atom cavity coupling of the <span>$j$</span>-th atom is denoted by <span>$g_j$</span>. Additionally there are dissipative processes in the system: Atoms are incoherently pumped with the rate <span>$R$</span>, they decay individually with the rate <span>$\Gamma$</span> and are affected by individual atomic dephasing with the rate <span>$\nu$</span>. Furthermore, photons leak out of the system with the rate <span>$\kappa$</span>.</p><p>We start by loading the packages.</p><pre><code class="language-julia">using QuantumCumulants
using OrdinaryDiffEq, SteadyStateDiffEq, ModelingToolkit
using Plots</code></pre><p>Due to the implementation of symbolic indices and sums we only need to define the Hilbert space for one atom, even though we will simulate a system for several thousand. Creating an operator with an <span>$\texttt{Index}$</span> is done with the constructor <span>$\texttt{IndexedOperator}$</span>.</p><pre><code class="language-julia"># Hilbertspace
hc = FockSpace(:cavity)
ha = NLevelSpace(:atom,2)
h = hc ⊗ ha

# operators
@qnumbers a::Destroy(h)
σ(α,β,i) = IndexedOperator(Transition(h, :σ, α, β),i)</code></pre><p>Now we define the indices and the parameters of the system. An <span>$\texttt{Index}$</span> needs the system Hilbert space, a symbol, an upper bound and the specific Hilbert space of the indexed operator. <span>$\texttt{IndexedVariable}$</span> creates indexed variables. Actually we wouldn&#39;t need indexed variable in this example, this is just for demonstration purposes.</p><pre><code class="language-julia">@cnumbers N Δ κ Γ R ν
g(i) = IndexedVariable(:g, i)

i = Index(h,:i,N,ha)
j = Index(h,:j,N,ha)</code></pre><pre class="documenter-example-output">Index(ℋ(cavity) ⊗ ℋ(atom), :j, N, 2)</pre><p>We define the Hamiltonian using symbolic sums and define the individual dissipative processes. For an indexed jump operator the (symbolic) sum is build in the Liouvillian.</p><pre><code class="language-julia"># Hamiltonian
H = -Δ*a&#39;a + Σ(g(i)*( a&#39;*σ(1,2,i) + a*σ(2,1,i) ),i)

# Jump operators wth corresponding rates
J = [a, σ(1,2,i), σ(2,1,i), σ(2,2,i)]
rates = [κ, Γ, R, ν]</code></pre><p>First we want to derive the equation for <span>$\langle a^\dagger a \rangle$</span> and <span>$\langle \sigma_j^{22} \rangle$</span>. Note that you can only use indices on the LHS which haven&#39;t been used for the Hamiltonian and the jumps.</p><pre><code class="language-julia"># Derive equations
ops = [a&#39;*a, σ(2,2,j)]
eqs = meanfield(ops,H,J;rates=rates,order=2)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; 1 i \underset{i}{\overset{N}{\sum}} {g}_{i}  \langle a  {\sigma}_{i}^{{21}}\rangle  -1 i \underset{i}{\overset{N}{\sum}} {g}_{i}  \langle a^\dagger  {\sigma}_{i}^{{12}}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{j}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{j}^{{22}}\rangle  + 1 i {g}_{j} \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -1 i {g}_{j} \langle a  {\sigma}_{j}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma}_{j}^{{22}}\rangle
\end{align}\]</p><p>To get a closed set of equations we automatically complete the system. Since this system is phase invariant we know that all averages with a phase are zero, therefore we exclude these terms with a filter function. To be able to dispatch on all kind of sums containing averages we defined the Union <span>$\texttt{AvgSums}$</span>.</p><pre><code class="language-"># custom filter function
φ(x::Average) = φ(x.arguments[1])
φ(::Destroy) = -1
φ(::Create) =1
φ(x::QTerm) = sum(map(φ, x.args_nc))
φ(x::Transition) = x.i - x.j
φ(x::IndexedOperator) = x.op.i - x.op.j
φ(x::SingleSum) = φ(x.term)
φ(x::AvgSums) = φ(arguments(x))
phase_invariant(x) = iszero(φ(x))

# Complete equations
eqs_c = complete(eqs; filter_func=phase_invariant)
nothing # hide</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; 1 i \underset{i}{\overset{N}{\sum}} {g}_{i}  \langle a  {\sigma}_{i}^{{21}}\rangle  -1 i \underset{i}{\overset{N}{\sum}} {g}_{i}  \langle a^\dagger  {\sigma}_{i}^{{12}}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{j}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{j}^{{22}}\rangle  + 1 i {g}_{j} \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -1 i {g}_{j} \langle a  {\sigma}_{j}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma}_{j}^{{22}}\rangle  \\
\frac{d}{dt} \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  =&amp; 1 i \underset{i{\ne}j}{\overset{N}{\sum}} {g}_{i}  \langle {\sigma}_{i}^{{21}}  {\sigma}_{j}^{{12}}\rangle  + 1 i {g}_{j} \langle {\sigma}_{j}^{{22}}\rangle  -1 i {g}_{j} \langle a^\dagger  a\rangle  -0.5 R \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -0.5 \Gamma \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -0.5 \kappa \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -0.5 \nu \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -1 i \Delta \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  + 2 i {g}_{j} \langle {\sigma}_{j}^{{22}}\rangle  \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{j}^{{12}}  {\sigma}_{k}^{{21}}\rangle  =&amp; \left( -1.0 R -1.0 \Gamma \right) \langle {\sigma}_{j}^{{12}}  {\sigma}_{k}^{{21}}\rangle  -1 i {g}_{j} \langle a  {\sigma}_{k}^{{21}}\rangle  + 1 i {g}_{k} \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle  -1.0 \nu \langle {\sigma}_{j}^{{12}}  {\sigma}_{k}^{{21}}\rangle  + 2 i {g}_{j} \langle {\sigma}_{j}^{{22}}\rangle  \langle a  {\sigma}_{k}^{{21}}\rangle  -2 i {g}_{k} \langle {\sigma}_{k}^{{22}}\rangle  \langle a^\dagger  {\sigma}_{j}^{{12}}\rangle
\end{align}\]</p><p>As mentioned before, we assume that all atoms behave identical. This means that e.g. the excited state population is equal for all atoms, hence we only need to calculate it for the first <span>$\langle \sigma^{22}_1 \rangle = \langle \sigma^{22}_j \rangle$</span>. Furthermore, it is clear that a sum over <span>$N$</span> identical objects can be replaced by <span>$N$</span> times the object. The function <span>$\texttt{scale()}$</span> uses these rules to simplify the equations.</p><pre><code class="language-">eqs_sc = scale(eqs_c)
nothing # hide</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 \kappa \langle a^\dagger  a\rangle  -1 i N g_{1} \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 1 i N g_{1} \langle a  {\sigma}_{1}^{{21}}\rangle  \\
\frac{d}{dt} \langle {\sigma}_{1}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma}_{1}^{{22}}\rangle  -1.0 \Gamma \langle {\sigma}_{1}^{{22}}\rangle  + 1 i g_{1} \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -1 i g_{1} \langle a  {\sigma}_{1}^{{21}}\rangle  \\
\frac{d}{dt} \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  =&amp; -0.5 R \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \Gamma \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \kappa \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -0.5 \nu \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 1 i g_{1} \langle {\sigma}_{1}^{{22}}\rangle  -1 i g_{1} \langle a^\dagger  a\rangle  -1 i \Delta \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 1 i g_{1} \left( -1 + N \right) \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  + 2 i g_{1} \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  =&amp; \left( -1.0 R -1.0 \Gamma \right) \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  + 1 i g_{1} \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  -1 i g_{1} \langle a  {\sigma}_{1}^{{21}}\rangle  -1.0 \nu \langle {\sigma}_{1}^{{12}}  {\sigma}_{2}^{{21}}\rangle  -2 i g_{1} \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  {\sigma}_{1}^{{12}}\rangle  + 2 i g_{1} \langle {\sigma}_{1}^{{22}}\rangle  \langle a  {\sigma}_{1}^{{21}}\rangle
\end{align}\]</p><p>To calculate the dynamics of the system we create a system of ordinary differential equations, which can be used by <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>.</p><pre><code class="language-">@named sys = ODESystem(eqs_sc)
nothing # hide</code></pre><p>Finally we need to define the numerical parameters and the initial value of the system. We will consider <span>$2 \cdot 10^5$</span> Strontium atoms which are repumped with a rate of <span>$R = 1\text{Hz}$</span> on the clock transition (<span>$\Gamma = 1 \text{mHz}$</span>). The atom-cavity coupling rate is <span>$g = 1\text{Hz}$</span>, the cavity has a linewidth of <span>$\kappa = 5\text{kHz}$</span> and is detuned from the atomic resonance by <span>$\Delta = 2.5\text{Hz}$</span>.</p><pre><code class="language-"># Initial state
u0 = zeros(ComplexF64, length(eqs_sc))
# System parameters
N_ = 2e5
Γ_ = 1.0 #Γ=1mHz
Δ_ = 2500Γ_ #Δ=2.5Hz
g_ = 1000Γ_ #g=1Hz
κ_ = 5e6*Γ_ #κ=5kHz
R_ = 1000Γ_ #R=1Hz
ν_ = 1000Γ_ #ν=1Hz

ps = [N, Δ, g(1), κ, Γ, R, ν]
p0 = [N_, Δ_, g_, κ_, Γ_, R_, ν_]

prob = ODEProblem(sys,u0,(0.0, 1.0/50Γ_), ps.=&gt;p0)
nothing # hide</code></pre><pre><code class="language-"># Solve the numeric problem
sol = solve(prob,Tsit5(),maxiters=1e7)

# Plot time evolution
t = sol.t
n = real.(sol[a&#39;a])
s22 = real.(sol[σ(2,2,1)])
# Plot
p1 = plot(t, n, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨a⁺a⟩&quot;, legend=false)
p2 = plot(t, s22, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨σ22⟩&quot;, legend=false)
plot(p1, p2, layout=(1,2), size=(700,300))
savefig(&quot;superradiant_laser_indexed.svg&quot;) # hide</code></pre><p><img src="superradiant_laser_indexed.svg" alt="svg"/></p><h2 id="Spectrum"><a class="docs-heading-anchor" href="#Spectrum">Spectrum</a><a id="Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Spectrum" title="Permalink"></a></h2><p>We calculate the spectrum here with the Laplace transform of the two-time corelation function. This is implemented with the function <span>$\texttt{Spectrum}$</span>.</p><pre><code class="language-">corr = CorrelationFunction(a&#39;, a, eqs_c; steady_state=true, filter_func=phase_invariant)
corr_sc = scale(corr)
S = Spectrum(corr_sc, ps)
nothing # hide</code></pre><p>The set of equations for the correlation function is given by</p><pre><code class="language-">corr_sc.de
nothing # hide</code></pre><p class="math-container">\[\begin{align}
\frac{d}{d\tau} \langle a^\dagger  a_0\rangle  =&amp; -0.5 \kappa \langle a^\dagger  a_0\rangle  -1 i \Delta \langle a^\dagger  a_0\rangle  + 1 i N g_{1} \langle {\sigma}_{1}^{{21}}  a_0\rangle  \\
\frac{d}{d\tau} \langle {\sigma}_{1}^{{21}}  a_0\rangle  =&amp; -0.5 R \langle {\sigma}_{1}^{{21}}  a_0\rangle  + 1 i g_{1} \langle a^\dagger  a_0\rangle  -0.5 \Gamma \langle {\sigma}_{1}^{{21}}  a_0\rangle  -0.5 \nu \langle {\sigma}_{1}^{{21}}  a_0\rangle  -2 i g_{1} \langle {\sigma}_{1}^{{22}}\rangle  \langle a^\dagger  a_0\rangle
\end{align}\]</p><p>To ensure we are in the steady state we use a steady solver to calculate it. To this end we need to define the <span>$\texttt{SteadyStateProblem}$</span> and specify the desired method. We also need to increase the <span>$\texttt{maxiters}$</span> and the solver accuracy to handle this numerically involved problem.</p><pre><code class="language-">prob_ss = SteadyStateProblem(prob)
sol_ss = solve(prob_ss, DynamicSS(Tsit5(); abstol=1e-8, reltol=1e-8),
        reltol=1e-14, abstol=1e-14, maxiters=5e7)
nothing # hide</code></pre><p>The spectrum is then calculated with</p><pre><code class="language-">ω = [-10:0.01:10;]Γ_
spec = S(ω,sol_ss.u,p0)
spec_n = spec ./ maximum(spec)
δ = abs(ω[(findmax(spec)[2])])
nothing # hide</code></pre><pre><code class="language-">plot(ω, spec_n, xlabel=&quot;ω/Γ&quot;, legend=false, size=(500,300))
savefig(&quot;spectrum_superradiant_laser_indexed.svg&quot;) # hide</code></pre><p><img src="spectrum_superradiant_laser_indexed.svg" alt="svg"/></p><p>Beside the narrow linewidth we can also see another key feature of the superradiant laser here, namely the very weak cavity pulling. At a detunig of <span>$\Delta = 2500\Gamma$</span> there is only a shift of the laser light from the atomic resonance frequency of <span>$\delta = 1\Gamma$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ramsey_spectroscopy/">« Ramsey Spectroscopy</a><a class="docs-footer-nextpage" href="../cavity_antiresonance_indexed/">Cavity Antiresonance »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 2 December 2022 17:53">Friday 2 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
