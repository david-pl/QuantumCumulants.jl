<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cavity Antiresonance · QuantumCumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">QuantumCumulants.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../symbolic_sums/">Symbolic Sums and Indices</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li><a class="tocitem" href="../many-atom-laser/">Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li><a class="tocitem" href="../excitation-transport-chain/">Noisy excitation transport</a></li><li><a class="tocitem" href="../ramsey_spectroscopy/">Ramsey Spectroscopy</a></li><li><a class="tocitem" href="../superradiant_laser_indexed/">Superradiant Laser</a></li><li class="is-active"><a class="tocitem" href>Cavity Antiresonance</a></li><li><a class="tocitem" href="../filter-cavity_indexed/">Laser with Filter Cavities</a></li><li><a class="tocitem" href="../superradiant-laser/">Superradiant Laser (outdated)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Cavity Antiresonance</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cavity Antiresonance</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/cavity_antiresonance_indexed.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Cavity-Antiresonance"><a class="docs-heading-anchor" href="#Cavity-Antiresonance">Cavity Antiresonance</a><a id="Cavity-Antiresonance-1"></a><a class="docs-heading-anchor-permalink" href="#Cavity-Antiresonance" title="Permalink"></a></h1><p>In this example we investigate a system of <span>$N$</span> closely spaced quantum emitters inside a coherently driven single mode cavity. The model is descriped in <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.119.093601">D. Plankensteiner, et. al., Phys. Rev. Lett. 119, 093601 (2017)</a>. The Hamiltonian of this system is composed of three parts <span>$H = H_c + H_a + H_{\mathrm{int}}$</span>, the driven cavity <span>$H_c$</span>, the dipole-dipole interacting atoms <span>$H_a$</span> and the atom-cavity interaction <span>$H_\mathrm{int}$</span>:</p><p class="math-container">\[\begin{align}
H_\mathrm{c} &amp;= \hbar \Delta_c a^\dagger a + \hbar \eta (a^\dagger + a) \\
&amp;\\
H_a &amp;= \hbar \Delta_a \sum\limits_{j} \sigma_j^{22} + \hbar \sum\limits_{i \neq j} \Omega_{ij} \sigma_i^{21} \sigma_j^{12}
&amp;\\
H_\mathrm{int} &amp;= \hbar \sum\limits_{j} g_j (a^\dagger \sigma_j^{12} + a \sigma_j^{21})
\end{align}\]</p><p>Additionally the system features two decay channels, the lossy cavity with photon decay rate <span>$\kappa$</span> and collective atomic emission described by the decay-rate matrix <span>$\Gamma_{ij}$</span>.</p><p>We start by loading the packages.</p><pre><code class="language-julia">using QuantumCumulants
using OrdinaryDiffEq, SteadyStateDiffEq, ModelingToolkit
using Plots</code></pre><p>The Hilbert space for this system is given by one cavity mode and <span>$N$</span> two-level atoms. Here we use symbolic indices, sums and double sums to define the system. The parameters <span>$g_j, \, \Gamma_{ij}$</span> and <span>$\Omega_{ij}$</span> are defined as indexed variables of atom <span>$i$</span> and <span>$j$</span>. We will describe the system in first order mean-field.</p><pre><code class="language-julia"># Hilbert space
hc = FockSpace(:cavity)
ha = NLevelSpace(Symbol(:atom),2)
h = hc ⊗ ha

# Parameter
@cnumbers N Δc η Δa κ
g(i) = IndexedVariable(:g,i)
Γ(i,j) = IndexedVariable(:Γ,i,j)
Ω(i,j) = IndexedVariable(:Ω,i,j;identical=false)

# Indices
i = Index(h,:i,N,ha)
j = Index(h,:j,N,ha)</code></pre><pre class="documenter-example-output">Index(ℋ(cavity) ⊗ ℋ(atom), :j, N, 2)</pre><p>The kwarg ’identical=false’ for the double indexed variable specifies that <span>$\Omega_{ij} = 0$</span> for <span>$i = j$</span>. Now we create the operators on the composite Hilbert space using the <span>$\texttt{IndexedOperator}$</span> constructor, which assigns each <span>$\texttt{Transition}$</span> operator an <span>$\texttt{Index}$</span>.</p><pre><code class="language-julia">@qnumbers a::Destroy(h)
σ(x,y,k) = IndexedOperator(Transition(h,:σ,x,y),k)</code></pre><p>We define the Hamiltonian and Liouvillian. For the collective atomic decay we write the corresponding dissipative processes with a double indexed variable <span>$R_{ij}$</span> and an indexed jump operator <span>$J_j$</span>, such that an operator average <span>$\langle \mathcal{O} \rangle$</span> follows the equation</p><p class="math-container">\[\begin{equation}
\langle \dot{\mathcal{O}} \rangle = \sum_{ij} R_{ij} \left( \langle J_i^\dagger \mathcal{O} J_j \rangle - \frac{1}{2} \langle J_i^\dagger J_j \mathcal{O} \rangle - \frac{1}{2} \langle \mathcal{O} J_i^\dagger J_j \rangle \right).
\end{equation}\]</p><pre><code class="language-julia"># Hamiltonian
Hc = Δc*a&#39;a + η*(a&#39; + a)
Ha = Δa*Σ(σ(2,2,i),i) + Σ(Ω(i,j)*σ(2,1,i)*σ(1,2,j),j,i)
Hi = Σ(g(i)*(a&#39;*σ(1,2,i) + a*σ(2,1,i)),i)
H = Hc + Ha + Hi

# Jump operators &amp; and rates
J = [a, σ(1,2,i)]
rates = [κ, Γ(i,j)]</code></pre><p>We derive the system of equations in first order mean-field.</p><pre><code class="language-julia">eqs = meanfield(a,H,J;rates=rates,order=1)
complete!(eqs)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a\rangle  =&amp; -1 i \eta -1 i \underset{i}{\overset{N}{\sum}} {g}_{i}  \langle {\sigma}_{i}^{{12}}\rangle  -0.5 \kappa \langle a\rangle  -1 i {\Delta}c \langle a\rangle  \\
\frac{d}{dt} \langle {\sigma}_{k}^{{12}}\rangle  =&amp; \underset{j{\ne}k}{\overset{N}{\sum}} {\Gamma}_{k,j}  \langle {\sigma}_{j}^{{12}}\rangle   \langle {\sigma}_{k}^{{22}}\rangle  -0.5 \underset{j}{\overset{N}{\sum}} {\Gamma}_{k,j}  \langle {\sigma}_{j}^{{12}}\rangle  -1 i \underset{j{\ne}i,k}{\overset{N}{\sum}} {\Omega}_{k,j}  \langle {\sigma}_{j}^{{12}}\rangle  + 2 i \underset{j{\ne}i,k}{\overset{N}{\sum}} {\Omega}_{k,j}  \langle {\sigma}_{j}^{{12}}\rangle   \langle {\sigma}_{k}^{{22}}\rangle  -1 i {g}_{k} \langle a\rangle  -1 i {\Delta}a \langle {\sigma}_{k}^{{12}}\rangle  + 2 i {g}_{k} \langle a\rangle  \langle {\sigma}_{k}^{{22}}\rangle  \\
\frac{d}{dt} \langle {\sigma}_{k}^{{22}}\rangle  =&amp; -0.5 \underset{i{\ne}j,k}{\overset{N}{\sum}} {\Gamma}_{i,k}  \langle {\sigma}_{i}^{{21}}\rangle   \langle {\sigma}_{k}^{{12}}\rangle  + 1 i \underset{i{\ne}j,k}{\overset{N}{\sum}} {\Omega}_{i,k}  \langle {\sigma}_{i}^{{21}}\rangle   \langle {\sigma}_{k}^{{12}}\rangle  -1 i \underset{j{\ne}i,k}{\overset{N}{\sum}} {\Omega}_{k,j}  \langle {\sigma}_{k}^{{21}}\rangle   \langle {\sigma}_{j}^{{12}}\rangle  -0.5 \underset{j{\ne}k}{\overset{N}{\sum}} {\Gamma}_{k,j}  \langle {\sigma}_{k}^{{21}}\rangle   \langle {\sigma}_{j}^{{12}}\rangle  -1.0 {\Gamma}_{k,k} \langle {\sigma}_{k}^{{22}}\rangle  -1 i {g}_{k} \langle a\rangle  \langle {\sigma}_{k}^{{21}}\rangle  + 1 i {g}_{k} \langle a^\dagger\rangle  \langle {\sigma}_{k}^{{12}}\rangle
\end{align}\]</p><p>To create the equations for a specific number of atoms we use the function <span>$\texttt{evaluate}$</span>.</p><pre><code class="language-julia">N_ = 2
eqs_ = evaluate(eqs;limits=(N=&gt;N_))
@named sys = ODESystem(eqs_)</code></pre><p>Finally we need to define the initial state of the system and the numerical parameters. In the end we want to obtain the transmission rate <span>$T$</span> of our system. For this purpose we calculate the steady state photon number in the cavity <span>$|\langle a \rangle|^2$</span> for different laser frequencies.</p><pre><code class="language-julia">u0 = zeros(ComplexF64, length(eqs_))
# parameter
Γ_ = 1.0
d = 2π*0.08 #0.08λ
θ = π/2

Ωij(i,j) = i==j ? 0 : Γ_*(-3/4)*( (1-(cos(θ))^2)*cos(d)/d-(1-3*(cos(θ))^2)*(sin(d)/(d^2)+(cos(d)/(d^3))) )
Γij(i,j) = i==j ? Γ_ : Γ_*(3/2)*( (1-(cos(θ))^2)*sin(d)/d+(1-3*(cos(θ))^2)*((cos(d)/(d^2))-(sin(d)/(d^3))))

g_ = 2Γ_
κ_ = 20Γ_
Δa_ = 0Γ_
Δc_ = 0Γ_
η_ = κ_/100

gi_ls = [g(i) for i=1:N_]
Γij_ls = [Γ(i,j) for i = 1:N_ for j=1:N_]
Ωij_ls = [Ω(i,j) for i = 1:N_ for j=1:N_ if i≠j]

# list of symbolic indexed parameters
gi_ = [g_*(-1)^i for i=1:N_]
Γij_ = [Γij(i,j) for i = 1:N_ for j=1:N_]
Ωij_ = [Ωij(i,j) for i = 1:N_ for j=1:N_ if i≠j]

ps = [Δc; η; Δa; κ; gi_ls; Γij_ls; Ωij_ls]
p0 = [Δc_; η_; Δa_; κ_; gi_; Γij_; Ωij_]</code></pre><pre><code class="language-julia">Δ_ls = [-10:0.05:10;]Γ_
n_ls = zeros(length(Δ_ls))

# definitions for fast replacement of numerical parameter
prob = ODEProblem(sys,u0,(0.0, 20Γ_), ps.=&gt;p0)
prob_ss = SteadyStateProblem(prob)
p_sys = parameters(sys)
p_idx = [findfirst(isequal(p), ps) for p∈p_sys]

for i=1:length(Δ_ls)
    Δc_ = Δ_ls[i]
    Δa_ = Δc_ + Ωij(1,2) # cavity on resonace with the shifted collective emitter
    p0_ = [Δc_; η_; Δa_; κ_; gi_; Γij_; Ωij_]

    # create new SteadyStateProblem
    prob_ss_ = remake(prob_ss, p=p0_[p_idx])
    sol_ss = solve(prob_ss_, DynamicSS(Tsit5(); abstol=1e-8, reltol=1e-8),
        reltol=1e-14, abstol=1e-14, maxiters=5e7)
    n_ls[i] = abs2(sol_ss[a])
end</code></pre><pre class="documenter-example-output">┌ Warning: Assignment to `Δc_` in soft scope is ambiguous because a global variable by the same name exists: `Δc_` will be treated as a new local. Disambiguate by using `local Δc_` to suppress this warning or `global Δc_` to assign to the existing global variable.
└ @ none:3
┌ Warning: Assignment to `Δa_` in soft scope is ambiguous because a global variable by the same name exists: `Δa_` will be treated as a new local. Disambiguate by using `local Δa_` to suppress this warning or `global Δa_` to assign to the existing global variable.
└ @ none:4</pre><p>The transmission rate <span>$T$</span> with respect to the pump laser detuning is given by the relative steady state intra-cavity photon number <span>$n(\Delta)/n_\mathrm{max}$</span>. We qualitatively reproduce the antiresonance from <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.119.093601">D. Plankensteiner, et. al., Phys. Rev. Lett. 119, 093601 (2017)</a> for two atoms.</p><pre><code class="language-julia">T = n_ls ./ maximum(n_ls)
plot(Δ_ls, T, xlabel=&quot;Δ/Γ&quot;, ylabel=&quot;T&quot;, legend=false)</code></pre><pre class="documenter-example-output">&quot;/home/runner/work/QuantumCumulants.jl/QuantumCumulants.jl/docs/build/examples/cavity_antiresonance_indexed.svg&quot;</pre><p><img src="../cavity_antiresonance_indexed.svg" alt="svg"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../superradiant_laser_indexed/">« Superradiant Laser</a><a class="docs-footer-nextpage" href="../filter-cavity_indexed/">Laser with Filter Cavities »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 2 December 2022 20:59">Friday 2 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
